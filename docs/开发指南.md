# 开发指南

**为确保样式风格统一，开发时请尽量原样复制，需要注意（添加，修改或删除）的地方，已标明`! Warning`，可`CTRL + F`搜索定位。已是最简代码，请放心食用 (^\_^\*)。**

## 常见页面开发

`! Warning`：以下是系统中的全局样式类，部分必须应用，部分可酌情选择。

- `.app-container`
- `.filter-container`
- `.filter-item`
- `.custom-loading`
- `.table-border--hidden`
- `.form-item-submit`

### CURD

以下展示的完整代码示例，可参考`src/views/system/`目录下的 Vue 页面

#### step 1：页面容器

```html
<template>
  <div class="app-container">
    <!-- your content -->
  </div>
</template>
```

> `! Warning`：`.app-container`仅仅用作页面的容器，而非其他自行封装的组件的容器

#### step 2：表格

示例：

```html
<template>
  <div class="app-container">
    <v-table
      v-loading="loading"
      element-loading-text="正在加载..."
      element-loading-custom-class="custom-loading"
      :columns="columns"
      :data="tableData"
      :row-key="rowKey"
      border
      highlight-current-row
      height="100%"
      class="table-border--hidden"
      :columns-ctrl="columnsCtrl"
      @selection-change="handleSelectionChange"
    >
      <template #operation>
        <div style="width: 100%;">
          <el-button
            type="primary"
            icon="el-icon-circle-plus-outline"
            @click="handleCreateClick"
          >
            创建
          </el-button>

          <el-button
            type="primary"
            plain
            icon="el-icon-download"
            @click="exportXls('用户列表')"
          >
            导出
          </el-button>

          <el-popconfirm
            v-if="selectedRows.length > 0"
            cancelButtonType="default"
            title="确定删除吗？"
            style="margin-left: 10px;"
            @onConfirm="handleDeleteBatchClick"
          >
            <el-button
              slot="reference"
              type="primary"
              plain
              icon="el-icon-delete"
            >
              批量删除
            </el-button>
          </el-popconfirm>
        </div>
      </template>

      <template #action="{ row }">
        <el-button
          type="text"
          icon="el-icon-edit-outline"
          @click.stop="handleEditClick(row)"
          >编辑</el-button
        >
        <el-divider direction="vertical" />
        <el-popconfirm
          cancelButtonType="default"
          title="确定删除吗？"
          @onConfirm="handleDeleteClick(row)"
        >
          <el-button slot="reference" type="text" icon="el-icon-delete"
            >删除</el-button
          >
        </el-popconfirm>
      </template>
    </v-table>
  </div>
</template>
```

```js
<script>
import { PageTableMixin, CurdMixin, ExportMixin } from '@/mixins'
import { userUrl } from '@/api/url'

export default {
  // 组件名字
  name: 'UserList',
  mixins: [PageTableMixin, CurdMixin, ExportMixin],
  components: {
    UserForm: () => import('./forms/UserForm'),
  },
  data() {
    return {
      // 接口url
      url: {
        data: userUrl.page,
        delete: userUrl.delete,
        deleteBatch: userUrl.deleteBatch,
        exportXls: userUrl.exportXls,
      },
      // 表格列
      columns: [
        {
          label: '多选',
          prop: 'selection',
          type: 'selection',
          align: 'center',
        },
        {
          label: '用户账号',
          prop: 'username',
          align: 'center',
        },
        {
          label: '头像',
          prop: 'avatar',
          align: 'center',
          scopedSlots: true,
        },
        {
          label: '性别',
          prop: 'sex_dictText',
          align: 'center',
        },
        {
          label: '状态',
          prop: 'status_dictText',
          align: 'center',
        },
        {
          label: '操作',
          prop: 'action',
          align: 'center',
          width: '140px',
          scopedSlots: true,
        },
      ],
      // 排序条件
      sortord: {
        column: 'createTime',
        order: 'desc',
      },
      // 列隐藏控制
      columnsCtrl: {
        props: {
          placement: 'bottom-end',
          visibleArrow: false,
        },
      },
      // end <---- table
    }
  },
  mounted() {
    this.loadData()
  },
}
</script>
```

```html
<style lang="scss" scoped></style>
```

复制粘贴好以上代码之后，只需要酌情依此修改，`name`,`components`,`rowkey`,`url`,`columns`, `sorted`，还有 _导出_ 点击事件的参数，就可实现基本的分页表格页面了。

> `! Warning`：`name`定义页面的名字，一般跟文件名一致。`components`中注册表单组件。表单组件的指南后面会提到。`url`中定义接口 url。`columns`定义表格的列信息。`sorted`定义表格的排序。如果不需要表格的列控制，可删除表格上的`columns-ctrl`属性和`data`中的`columnsCtrl`。

rowKey

> `! Warning`：删除，批量删除，选择导出和表单都会用到此属性，请一定要确认`row-key`属性，此属性是表格每一行的数据的唯一标识，一般来说是每行数据项的`id`字段。此处默认取的`rowKey`变量，该变量默认是字符串`id`，共有两种修改方式，如下示例：

1. 指定属性名

   ```js
   data(){
     return {
       rowKey: 'id'
     }
   }
   ```

2. 定义方法，返回唯一标识

   ```js
   methods:{
     getRowkey(row){
       return row.id
     }
   }
   ```

#### step 3：表单
